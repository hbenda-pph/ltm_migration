config {
  type: "view",
  schema: "silver", 
  name: "vw_sold_estimates",
  description: "Vista SOLD ESTIMATES",
  tags: ["silver", "ltm", "sold_estimates"]
}

SELECT e.business_unit_name AS `Business Unit`
     , e.id                 AS `Estimate Id`
     , e.name               AS `Estimate Name`
     , e.job_id             AS `Parent Job Number`
     , e.status_name        AS `Estimate Status`
     , e.subtotal           AS `Estimate Subtotal`
     , DATE(e.sold_on)      AS `Sold On`
     , e.customer_id        AS `Customer Id`     
     , c.name               AS `Customer Name`     
     , t.name               AS `Sold By`     
FROM `${dataform.projectId}.${dataform.vars.raw_dataset}.estimate`        e
LEFT JOIN `${dataform.projectId}.${dataform.vars.raw}.customer`   c
  ON c.id                   = e.customer_id
LEFT JOIN `${dataform.projectId}.${dataform.vars.raw}.technician` t
  ON t.id                   = e.sold_by